<!DOCTYPE html>

<html lang="en">

<head>

<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Cyberpunk Weather Dashboard</title>

<style>

@import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');

:root {

 --cyber-blue: #0ff;

 --cyber-pink: #f0f;

 --cyber-green: #0f0;

 --cyber-purple: #a0f;

 --cyber-orange: #ff5500;

 --grid-color: rgba(0, 255, 255, 0.1);

}

* {

 margin: 0;

 padding: 0;

 box-sizing: border-box;

}

body {

 font-family: 'Orbitron', monospace;

 background: #000811;

 color: var(--cyber-blue);

 overflow-x: hidden;

 min-height: 100vh;

 position: relative;

}

/* Background Grid */

body::before {

 content: "";

 position: fixed;

 inset: 0;

 background: 

  linear-gradient(90deg, var(--grid-color) 1px, transparent 1px) 0 0 / 50px 50px,

  linear-gradient(0deg, var(--grid-color) 1px, transparent 1px) 0 0 / 50px 50px,

  radial-gradient(circle at 50% 50%, rgba(0, 40, 80, 0.3), #000811);

 pointer-events: none;

 z-index: -4;

}

/* Weather Effects */

.sunny-bg {

 background: 

  radial-gradient(circle at 20% 10%, #ff880033, transparent 50%),

  radial-gradient(circle at 80% 90%, #0088ff33, transparent 50%),

  linear-gradient(to bottom, #000c1a, #001a33);

 animation: skyShift 60s infinite linear;

}

.cloudy-bg {

 background: linear-gradient(to bottom, #001122, #003344);

 animation: cloudySky 120s infinite linear;

}

.rainy-bg {

 background: linear-gradient(to bottom, #001133, #002244);

}

.stormy-bg {

 background: linear-gradient(to bottom, #000811, #001122);

 animation: stormSky 30s infinite linear;

}

@keyframes skyShift {

 0%, 100% { background-position: 0 0, 0 0; }

 50% { background-position: 100px 50px, -100px -50px; }

}

@keyframes cloudySky {

 0% { background-position: 0 0; }

 100% { background-position: 1000px 1000px; }

}

@keyframes stormSky {

 0%, 100% { filter: brightness(1); }

 50% { filter: brightness(1.1); }

}

#sunGlow, .sun-rays, #cloudContainer, #rainContainer {

 position: fixed;

 pointer-events: none;

 z-index: -2;

 opacity: 0;

}

#sunGlow {

 top: 10%;

 left: 15%;

 width: 120px;

 height: 120px;

 background: radial-gradient(circle, #ffaa00, #ff5500, transparent 70%);

 border-radius: 50%;

 filter: blur(40px);

 animation: sunPulse 8s infinite ease-in-out;

}

.sun-rays {

 top: 10%;

 left: 15%;

 width: 120px;

 height: 120px;

 background: conic-gradient(from 0deg, transparent 0deg, rgba(255, 170, 0, 0.2) 15deg, transparent 30deg, rgba(255, 85, 0, 0.2) 45deg, transparent 60deg);

 border-radius: 50%;

 animation: rotateRays 20s linear infinite;

}

#cloudContainer {

 inset: 0;

 perspective: 1000px;

}

#rainContainer {

 inset: 0;

 overflow: hidden;

}

@keyframes sunPulse {

 0%, 100% { opacity: 0.6; transform: scale(1); }

 50% { opacity: 0.8; transform: scale(1.1); }

}

@keyframes rotateRays {

 from { transform: rotate(0deg); }

 to { transform: rotate(360deg); }

}

/* UI Components */

.container {

 padding: 20px;

 max-width: 1200px;

 margin: 0 auto;

 width: 100%;

}

.header-glow {

 text-align: center;

 margin-bottom: 20px;

}

.header-glow h1 {

 font-size: 2em;

 font-weight: 900;

 text-shadow: 

  0 0 10px var(--cyber-blue),

  0 0 20px var(--cyber-blue),

  0 0 40px var(--cyber-blue),

  0 0 80px var(--cyber-blue);

 animation: textGlow 2s infinite alternate;

 margin-bottom: 10px;

}

@keyframes textGlow {

 from { text-shadow: 0 0 10px var(--cyber-blue), 0 0 20px var(--cyber-blue); }

 to { text-shadow: 0 0 20px var(--cyber-blue), 0 0 40px var(--cyber-blue), 0 0 60px var(--cyber-blue); }

}

.top {

 display: flex;

 gap: 10px;

 margin-bottom: 20px;

 flex-wrap: wrap;

 align-items: center;

 background: rgba(0, 20, 40, 0.7);

 padding: 15px;

 border-radius: 10px;

 border: 2px solid var(--cyber-blue);

 box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);

}

#city {

 flex: 1;

 padding: 12px;

 background: rgba(0, 0, 0, 0.8);

 border: 2px solid var(--cyber-blue);

 color: var(--cyber-blue);

 border-radius: 6px;

 font-family: 'Orbitron', monospace;

 font-size: 14px;

 min-width: 200px;

}

button {

 padding: 12px 20px;

 background: linear-gradient(135deg, #000, #002);

 border: 2px solid;

 color: #fff;

 font-weight: bold;

 cursor: pointer;

 transition: all 0.3s ease;

 font-family: 'Orbitron', monospace;

 font-size: 12px;

 border-radius: 6px;

 text-transform: uppercase;

 letter-spacing: 1px;

 position: relative;

 overflow: hidden;

 min-width: 140px;

}

button::before {

 content: '';

 position: absolute;

 top: 0;

 left: -100%;

 width: 100%;

 height: 100%;

 background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);

 transition: 0.5s;

}

button:hover::before {

 left: 100%;

}

#scan {

 border-color: var(--cyber-pink);

 color: var(--cyber-pink);

 text-shadow: 0 0 10px var(--cyber-pink);

}

#scan:hover {

 box-shadow: 0 0 20px var(--cyber-pink);

 background: linear-gradient(135deg, #200020, #400040);

}

.gpsBtn {

 border-color: var(--cyber-green);

 color: var(--cyber-green);

 text-shadow: 0 0 10px var(--cyber-green);

}

.gpsBtn:hover {

 box-shadow: 0 0 20px var(--cyber-green);

 background: linear-gradient(135deg, #002000, #004000);

}

.grid {

 display: grid;

 grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));

 gap: 15px;

 margin: 15px 0;

}

.card {

 background: linear-gradient(145deg, rgba(0, 20, 40, 0.9), rgba(0, 10, 20, 0.9));

 border: 2px solid var(--cyber-blue);

 border-radius: 10px;

 padding: 20px;

 box-shadow: 

  0 0 15px rgba(0, 255, 255, 0.3),

  inset 0 0 15px rgba(0, 255, 255, 0.1);

 transition: all 0.3s ease;

 position: relative;

 overflow: hidden;

 min-height: 200px;

}

.card::before {

 content: '';

 position: absolute;

 top: 0;

 left: 0;

 right: 0;

 height: 2px;

 background: linear-gradient(90deg, transparent, var(--cyber-blue), transparent);

}

.card:hover {

 transform: translateY(-5px);

 box-shadow: 

  0 0 25px rgba(0, 255, 255, 0.5),

  0 5px 15px rgba(0, 0, 0, 0.5),

  inset 0 0 20px rgba(0, 255, 255, 0.2);

}

.chart-container {

 width: 100%;

 background: linear-gradient(145deg, rgba(0, 20, 40, 0.9), rgba(0, 10, 20, 0.9));

 border: 2px solid var(--cyber-purple);

 border-radius: 10px;

 padding: 20px;

 margin-top: 20px;

 box-shadow: 0 0 20px rgba(160, 0, 255, 0.3);

}

.chart-header {

 display: flex;

 justify-content: space-between;

 align-items: center;

 margin-bottom: 15px;

 flex-wrap: wrap;

 gap: 10px;

}

#hourChart {

 width: 100%;

 height: 250px;

 background: rgba(0, 0, 0, 0.3);

 border-radius: 8px;

 padding: 10px;

}

.aqi-container {

 display: flex;

 flex-direction: column;

 align-items: center;

 gap: 15px;

}

.aqi-ring {

 position: relative;

 width: 150px;

 height: 150px;

}

.aqi-circle-bg, .aqi-circle {

 position: absolute;

 width: 100%;

 height: 100%;

 border-radius: 50%;

}

.aqi-circle-bg {

 background: conic-gradient(#111 0deg, #111 360deg);

}

.aqi-circle {

 background: conic-gradient(var(--aqi-color, #0f0) 0deg, #111 0deg);

 transition: background 1s ease;

}

.aqi-value {

 position: absolute;

 top: 50%;

 left: 50%;

 transform: translate(-50%, -50%);

 font-size: 32px;

 font-weight: 900;

 color: var(--aqi-color, #0f0);

 text-shadow: 0 0 15px currentColor;

}

.aqi-label {

 font-size: 12px;

 color: var(--aqi-color, #0f0);

 text-transform: uppercase;

 letter-spacing: 1px;

 font-weight: bold;

}

.moon-phase {

 display: flex;

 align-items: center;

 gap: 15px;

 margin-top: 10px;

}

.moon-visual {

 width: 70px;

 height: 70px;

 border-radius: 50%;

 background: linear-gradient(135deg, #333, #111);

 position: relative;

 overflow: hidden;

 box-shadow: 

  inset 0 0 15px rgba(255, 255, 255, 0.1),

  0 0 20px rgba(255, 255, 255, 0.2);

}

.moon-fill {

 position: absolute;

 height: 100%;

 background: linear-gradient(135deg, #ddd, #aaa);

 border-radius: 50%;

 transition: width 1s ease;

}

.altitude-display {

 display: flex;

 align-items: center;

 gap: 12px;

 margin-top: 10px;

 padding: 12px;

 background: rgba(0, 20, 40, 0.5);

 border-radius: 8px;

 border-left: 3px solid var(--cyber-orange);

}

.forecast-grid {

 display: grid;

 grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));

 gap: 12px;

 margin-top: 15px;

}

.forecast-card {

 background: rgba(0, 30, 60, 0.7);

 border: 1px solid var(--cyber-blue);

 border-radius: 8px;

 padding: 12px;

 text-align: center;

 transition: all 0.3s ease;

 min-height: 100px;

 display: flex;

 flex-direction: column;

 justify-content: center;

}

#humidityBar {

 height: 8px;

 background: #002;

 border-radius: 4px;

 margin-top: 10px;

 overflow: hidden;

}

#humidityFill {

 height: 100%;

 background: #0ff;

 border-radius: 5px;

 width: 0%;

}

@media (max-width: 768px) {

 .container { padding: 15px; }

 .header-glow h1 { font-size: 1.5em; }

 .top { flex-direction: column; }

 #city, button { width: 100%; min-width: auto; }

 .grid { grid-template-columns: 1fr; }

 .forecast-grid { grid-template-columns: repeat(4, 1fr); }

 .card { min-height: 180px; padding: 15px; }

 .chart-header { flex-direction: column; align-items: flex-start; }

 #hourChart { height: 220px; }

}

@media (max-width: 480px) {

 .container { padding: 10px; }

 .forecast-grid { grid-template-columns: repeat(2, 1fr); }

 .aqi-ring { width: 120px; height: 120px; }

 .aqi-value { font-size: 28px; }

 .moon-visual { width: 60px; height: 60px; }

}

</style>

</head>

<body>

<!-- Weather Effects -->

<div id="sunGlow"></div>

<div class="sun-rays"></div>

<div id="cloudContainer"></div>

<div id="rainContainer"></div>

<!-- Main Content -->

<div class="container">

 <div class="header-glow">

  <h1>CYBER WEATHER SCAN</h1>

  <div class="top">

   <input type="text" id="city" placeholder="ENTER CITY NAME..." autocomplete="off">

   <button id="scan">SCAN WEATHER</button>

   <button id="gps" class="gpsBtn">GPS LOCK</button>

  </div>

 </div>

 <div id="currentCity" style="text-align:center; margin:10px 0; font-size:1.2em; color:var(--cyber-blue);">[ Enter city or use GPS ]</div>

 <div class="grid">

  <div class="card" id="currentWeather">

   <h3 style="color:var(--cyber-blue); margin:0 0 10px 0;">CURRENT SCAN</h3>

   <div id="weatherIcon" style="font-size:50px; margin:10px 0;">‚è≥</div>

   <div id="tempDisplay" style="font-size:22px; font-weight:bold; margin:5px 0;">--¬∞C</div>

   <div id="feelsLike" style="font-size:14px; color:#aaa;">Feels like --¬∞C</div>

   <div class="altitude-display">

    <div class="altitude-icon">‚õ∞Ô∏è</div>

    <div>

     <div class="altitude-value" id="altitudeValue">--</div>

     <div class="altitude-unit">feet above sea level</div>

    </div>

   </div>

  </div>

  <div class="card" id="sunMoonInfo">

   <h3 style="color:var(--cyber-pink); margin:0 0 10px 0;">CELESTIAL DATA</h3>

   <div style="margin:10px 0;">

    <div style="color:#0ff; font-size:14px;">SUNRISE: <span id="sunriseTime">--:--</span></div>

    <div style="color:#0ff; font-size:14px; margin-top:8px;">SUNSET: <span id="sunsetTime">--:--</span></div>

   </div>

   <div class="moon-phase">

    <div class="moon-visual"><div class="moon-fill" id="moonFill"></div></div>

    <div>

     <div class="moon-phase-text">MOON PHASE</div>

     <div style="color:#fff; font-size:16px; margin-top:3px;" id="moonPhase">--</div>

    </div>

   </div>

  </div>

  <div class="card">

   <h3 style="color:var(--cyber-green); margin:0 0 10px 0;">AIR QUALITY SCAN</h3>

   <div class="aqi-container">

    <div class="aqi-ring">

     <div class="aqi-circle-bg"></div>

     <div class="aqi-circle" id="aqiCircle"></div>

     <div class="aqi-value" id="aqiValue">--</div>

    </div>

    <div class="aqi-label" id="aqiLabel">SCANNING...</div>

   </div>

  </div>

 </div>

 <h3 style="color:var(--cyber-blue); margin:25px 0 15px 0;">WEATHER METRICS</h3>

 <div class="grid">

  <div class="card">

   <div style="color:#aaa; font-size:14px;">HUMIDITY</div>

   <div id="humidityValue" style="font-size:28px; margin:10px 0;">--%</div>

   <div id="humidityBar"><div id="humidityFill"></div></div>

  </div>

  <div class="card">

   <div style="color:#aaa; font-size:14px;">UV INDEX</div>

   <div id="uvValue" style="font-size:28px; margin:10px 0;">--</div>

   <div id="uvRisk" style="color:#ff0; font-size:12px; margin-top:5px;">--</div>

  </div>

  <div class="card">

   <div style="color:#aaa; font-size:14px;">PRECIPITATION</div>

   <div id="precipValue" style="font-size:28px; margin:10px 0;">--%</div>

   <div style="color:#a0f; font-size:12px; margin-top:5px;">Chance of rain</div>

  </div>

  <div class="card">

   <div style="color:#aaa; font-size:14px;">WIND SPEED</div>

   <div id="windValue" style="font-size:28px; margin:10px 0;">-- km/h</div>

   <div id="windGustValue" style="color:#0f0; font-size:12px; margin-top:5px;">Gust: -- km/h</div>

  </div>

 </div>

 <h3 style="color:var(--cyber-pink); margin:25px 0 15px 0;">7-DAY FORECAST</h3>

 <div class="forecast-grid" id="forecastContainer"></div>

 <div class="chart-container">

  <div class="chart-header">

   <h3 style="color:var(--cyber-purple); margin:0;">HOURLY TEMPERATURE TREND</h3>

   <div style="color:#aaa; font-size:12px;">24-HOUR PREDICTION CYCLE</div>

  </div>

  <canvas id="hourChart"></canvas>

  <div style="display:flex; justify-content:space-between; margin-top:8px; color:#aaa; font-size:11px;">

   <div>‚Üê TIME (HOURS) ‚Üí</div>

   <div>‚Üë TEMPERATURE (¬∞C) ‚Üì</div>

  </div>

 </div>

</div>

<script>

class WeatherDashboard {

 constructor() {

  this.chart = null;

  this.weatherIcons = {

   0: "‚òÄÔ∏è", 1: "üå§Ô∏è", 2: "‚õÖ", 3: "‚òÅÔ∏è", 45: "üå´Ô∏è", 48: "üå´Ô∏è",

   61: "üåßÔ∏è", 63: "üåßÔ∏è", 65: "üåßÔ∏è", 66: "üå®Ô∏è", 67: "üå®Ô∏è",

   71: "‚ùÑÔ∏è", 73: "‚ùÑÔ∏è", 75: "‚ùÑÔ∏è", 77: "üå®Ô∏è", 80: "üå¶Ô∏è",

   81: "üå¶Ô∏è", 82: "üå¶Ô∏è", 85: "üå®Ô∏è", 86: "üå®Ô∏è", 95: "‚õàÔ∏è",

   96: "‚õàÔ∏è", 99: "‚õàÔ∏è"

  };

  

  this.cities = {

   'shimla': {lat: 31.1048, lon: 77.1734, alt: 2200, name: 'Shimla'},

   'delhi': {lat: 28.6139, lon: 77.2090, alt: 216, name: 'Delhi'},

   'mumbai': {lat: 19.0760, lon: 72.8777, alt: 14, name: 'Mumbai'},

   'chennai': {lat: 13.0827, lon: 80.2707, alt: 6, name: 'Chennai'},

   'kolkata': {lat: 22.5726, lon: 88.3639, alt: 9, name: 'Kolkata'},

   'bangalore': {lat: 12.9716, lon: 77.5946, alt: 920, name: 'Bangalore'},

   'hyderabad': {lat: 17.3850, lon: 78.4867, alt: 542, name: 'Hyderabad'},

   'pune': {lat: 18.5204, lon: 73.8567, alt: 560, name: 'Pune'},

   'london': {lat: 51.5074, lon: -0.1278, alt: 35, name: 'London'},

   'new york': {lat: 40.7128, lon: -74.0060, alt: 10, name: 'New York'},

   'tokyo': {lat: 35.6762, lon: 139.6503, alt: 40, name: 'Tokyo'},

   'paris': {lat: 48.8566, lon: 2.3522, alt: 35, name: 'Paris'}

  };

  

  this.init();

 }

 init() {

  this.setupEventListeners();

  this.loadDefaultWeather();

 }

 setupEventListeners() {

  try {

   document.getElementById('scan').addEventListener('click', () => this.handleSearch());

   document.getElementById('gps').addEventListener('click', () => this.handleGPS());

   document.getElementById('city').addEventListener('keypress', (e) => {

    if (e.key === 'Enter') this.handleSearch();

   });

  } catch (error) {

   console.log('Event listeners setup failed:', error);

  }

 }

 async handleSearch() {

  try {

   const city = document.getElementById('city').value.trim();

   if (!city) {

    this.showMessage('Please enter a city name', 'error');

    return;

   }

   await this.loadWeather(city);

  } catch (error) {

   this.showMessage('Search failed. Try again.', 'error');

   this.loadMockWeather('Shimla');

  }

 }

 async handleGPS() {

  try {

   if (!navigator.geolocation) {

    this.showMessage('GPS not supported by browser', 'error');

    return;

   }

   

   this.showMessage('Getting location...', 'loading');

   

   navigator.geolocation.getCurrentPosition(

    async (pos) => {

     try {

      const city = await this.reverseGeocode(pos.coords.latitude, pos.coords.longitude);

      document.getElementById('city').value = city;

      await this.loadWeather(city, pos.coords.latitude, pos.coords.longitude);

     } catch (error) {

      this.loadMockWeather('Your Location');

     }

    },

    () => this.showMessage('GPS access denied', 'error'),

    {timeout: 10000}

   );

  } catch (error) {

   this.showMessage('GPS scan failed', 'error');

   this.loadMockWeather('Your Location');

  }

 }

 async reverseGeocode(lat, lon) {

  try {

   const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lon}&localityLanguage=en`);

   const data = await response.json();

   return data.city || data.locality || 'Your Location';

  } catch {

   return 'Your Location';

  }

 }

 async loadDefaultWeather() {

  try {

   await this.loadWeather('Shimla');

  } catch {

   this.loadMockWeather('Shimla');

  }

 }

 async loadWeather(cityName, lat = null, lon = null) {

  try {

   this.showMessage(`Scanning ${cityName}...`, 'loading');

   

   let location = null;

   if (lat && lon) {

    location = {latitude: lat, longitude: lon, name: cityName};

   } else {

    location = await this.getLocation(cityName);

   }

   

   if (!location) {

    throw new Error('Location not found');

   }

   

   const weatherData = await this.getWeatherData(location.latitude, location.longitude);

   const altitude = this.getAltitude(cityName);

   const moonPhase = this.getMoonPhase();

   const aqi = this.calculateAQI(weatherData);

   

   this.updateUI(weatherData, location.name, altitude, moonPhase, aqi);

   this.setWeatherTheme(weatherData.current_weather.weathercode);

   this.createChart(weatherData.hourly.temperature_2m);

   this.updateForecast(weatherData.daily);

   

   this.showMessage(`${location.name} ‚Ä¢ ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`, 'success');

   

  } catch (error) {

   console.log('Weather load failed, using mock data:', error);

   this.loadMockWeather(cityName);

  }

 }

 async getLocation(cityName) {

  try {

   const normalized = cityName.toLowerCase().trim();

   

   // Check cached cities first

   if (this.cities[normalized]) {

    return this.cities[normalized];

   }

   

   // Try geocoding API

   try {

    const response = await fetch(`https://geocode.maps.co/search?q=${encodeURIComponent(cityName)}&format=json`);

    const data = await response.json();

    

    if (data && data[0]) {

     return {

      latitude: parseFloat(data[0].lat),

      longitude: parseFloat(data[0].lon),

      name: data[0].display_name.split(',')[0]

     };

    }

   } catch (apiError) {

    console.log('Geocoding API failed:', apiError);

   }

   

   // Generate random coordinates for unknown cities

   return {

    latitude: 20 + Math.random() * 50,

    longitude: 70 + Math.random() * 50,

    name: cityName,

    alt: Math.floor(Math.random() * 2000)

   };

   

  } catch (error) {

   console.log('Location fetch failed:', error);

   throw error;

  }

 }

 async getWeatherData(lat, lon) {

  try {

   // Use Open-Meteo API with fallback

   const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true&hourly=temperature_2m,relativehumidity_2m,precipitation_probability&daily=temperature_2m_max,temperature_2m_min,sunrise,sunset&timezone=auto`;

   

   const response = await fetch(url);

   

   if (!response.ok) {

    throw new Error('API response not ok');

   }

   

   const data = await response.json();

   

   if (!data.current_weather) {

    throw new Error('Invalid weather data');

   }

   

   return data;

   

  } catch (error) {

   console.log('Weather API failed, generating mock data:', error);

   return this.generateMockWeatherData();

  }

 }

 generateMockWeatherData() {

  const now = new Date();

  return {

   current_weather: {

    temperature: 20 + Math.random() * 15,

    windspeed: 5 + Math.random() * 20,

    weathercode: [0, 1, 2, 3, 45, 61, 65, 71, 80, 95][Math.floor(Math.random() * 10)]

   },

   hourly: {

    temperature_2m: Array.from({length: 24}, (_, i) => 18 + Math.sin(i/4) * 8 + Math.random() * 3),

    relativehumidity_2m: Array.from({length: 24}, () => 40 + Math.random() * 40),

    precipitation_probability: Array.from({length: 24}, () => Math.random() * 50)

   },

   daily: {

    temperature_2m_max: Array.from({length: 7}, (_, i) => 22 + Math.sin(i) * 5 + Math.random() * 3),

    temperature_2m_min: Array.from({length: 7}, (_, i) => 15 + Math.sin(i) * 3 + Math.random() * 3),

    sunrise: Array.from({length: 7}, () => `06:${30+Math.floor(Math.random()*30)}`),

    sunset: Array.from({length: 7}, () => `18:${30+Math.floor(Math.random()*30)}`)

   }

  };

 }

 loadMockWeather(cityName) {

  const weatherData = this.generateMockWeatherData();

  const altitude = this.getAltitude(cityName);

  const moonPhase = this.getMoonPhase();

  const aqi = this.calculateAQI(weatherData);

  

  this.updateUI(weatherData, cityName, altitude, moonPhase, aqi);

  this.setWeatherTheme(weatherData.current_weather.weathercode);

  this.createChart(weatherData.hourly.temperature_2m);

  this.updateForecast(weatherData.daily);

  

  this.showMessage(`${cityName} (Mock Data) ‚Ä¢ ${new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}`, 'info');

 }

 getAltitude(cityName) {

  const normalized = cityName.toLowerCase().trim();

  if (this.cities[normalized]) {

   return this.cities[normalized].alt;

  }

  return Math.floor(Math.random() * 2000);

 }

 getMoonPhase() {

  const phases = [

   {name: "New Moon", emoji: "üåë", fill: 0},

   {name: "Waxing Crescent", emoji: "üåí", fill: 0.25},

   {name: "First Quarter", emoji: "üåì", fill: 0.5},

   {name: "Waxing Gibbous", emoji: "üåî", fill: 0.75},

   {name: "Full Moon", emoji: "üåï", fill: 1},

   {name: "Waning Gibbous", emoji: "üåñ", fill: 0.75},

   {name: "Last Quarter", emoji: "üåó", fill: 0.5},

   {name: "Waning Crescent", emoji: "üåò", fill: 0.25}

  ];

  return phases[Math.floor(Math.random() * phases.length)];

 }

 calculateAQI(weatherData) {

  try {

   const base = 30 + Math.random() * 100;

   return Math.min(300, Math.max(0, Math.round(base)));

  } catch {

   return 50;

  }

 }

 updateUI(weatherData, cityName, altitude, moonPhase, aqi) {

  try {

   // Current weather

   const current = weatherData.current_weather;

   const icon = this.weatherIcons[current.weathercode] || "‚ùì";

   

   document.getElementById('weatherIcon').textContent = icon;

   document.getElementById('tempDisplay').textContent = `${Math.round(current.temperature)}¬∞C`;

   document.getElementById('feelsLike').textContent = `Feels like ${Math.round(current.temperature + 2)}¬∞C`;

   

   // Altitude

   const altitudeFeet = Math.round(altitude * 3.28084);

   document.getElementById('altitudeValue').textContent = altitudeFeet.toLocaleString();

   

   // Sun times

   document.getElementById('sunriseTime').textContent = weatherData.daily.sunrise[0]?.slice(11, 16) || '06:30';

   document.getElementById('sunsetTime').textContent = weatherData.daily.sunset[0]?.slice(11, 16) || '18:30';

   

   // Moon phase

   document.getElementById('moonFill').style.width = `${moonPhase.fill * 100}%`;

   document.getElementById('moonPhase').textContent = `${moonPhase.emoji} ${moonPhase.name}`;

   

   // AQI

   const aqiInfo = this.getAQIInfo(aqi);

   document.getElementById('aqiValue').textContent = aqi;

   document.getElementById('aqiValue').style.color = aqiInfo.color;

   document.getElementById('aqiLabel').textContent = aqiInfo.label;

   document.getElementById('aqiLabel').style.color = aqiInfo.color;

   document.getElementById('aqiCircle').style.background = 

    `conic-gradient(${aqiInfo.color} 0deg, ${aqiInfo.color} ${(aqi/300)*360}deg, #111 ${(aqi/300)*360}deg, #111 360deg)`;

   

   // Metrics

   const humidity = weatherData.hourly.relativehumidity_2m[0] || 50;

   document.getElementById('humidityValue').textContent = `${Math.round(humidity)}%`;

   document.getElementById('humidityFill').style.width = `${humidity}%`;

   

   const uvIndex = 2 + Math.random() * 10;

   document.getElementById('uvValue').textContent = uvIndex.toFixed(1);

   let uvRisk = 'Low', uvColor = '#0f0';

   if (uvIndex >= 8) { uvRisk = 'Very High'; uvColor = '#f00'; }

   else if (uvIndex >= 6) { uvRisk = 'High'; uvColor = '#ff0'; }

   else if (uvIndex >= 3) { uvRisk = 'Moderate'; uvColor = '#ff0'; }

   document.getElementById('uvRisk').textContent = uvRisk;

   document.getElementById('uvRisk').style.color = uvColor;

   

   const precip = weatherData.hourly.precipitation_probability[0] || 20;

   document.getElementById('precipValue').textContent = `${Math.round(precip)}%`;

   

   const windSpeed = current.windspeed;

   document.getElementById('windValue').textContent = `${Math.round(windSpeed)} km/h`;

   document.getElementById('windGustValue').textContent = `Gust: ${Math.round(windSpeed * 1.5)} km/h`;

   

  } catch (error) {

   console.log('UI update failed:', error);

  }

 }

 getAQIInfo(aqi) {

  if (aqi <= 50) return {label: "GOOD", color: "#0f0"};

  if (aqi <= 100) return {label: "MODERATE", color: "#ff0"};

  if (aqi <= 150) return {label: "UNHEALTHY", color: "#ff8800"};

  if (aqi <= 200) return {label: "BAD", color: "#ff3300"};

  return {label: "HAZARDOUS", color: "#ff0066"};

 }

 setWeatherTheme(weatherCode) {

  try {

   // Clear previous

   document.body.className = '';

   document.getElementById('sunGlow').style.opacity = '0';

   document.querySelector('.sun-rays').style.opacity = '0';

   document.getElementById('cloudContainer').style.opacity = '0';

   document.getElementById('rainContainer').style.opacity = '0';

   

   if (weatherCode === 0) {

    document.body.classList.add('sunny-bg');

    document.getElementById('sunGlow').style.opacity = '0.7';

    document.querySelector('.sun-rays').style.opacity = '0.4';

   } else if (weatherCode <= 3) {

    document.body.classList.add('cloudy-bg');

    this.createClouds(weatherCode === 3 ? 6 : 3);

   } else if (weatherCode >= 61 && weatherCode <= 82) {

    document.body.classList.add('rainy-bg');

    this.createRain();

   } else if (weatherCode >= 95) {

    document.body.classList.add('stormy-bg');

    this.createRain(true);

   }

  } catch (error) {

   console.log('Theme setting failed:', error);

  }

 }

 createClouds(count = 4) {

  try {

   const container = document.getElementById('cloudContainer');

   container.innerHTML = '';

   

   for (let i = 0; i < count; i++) {

    const cloud = document.createElement('div');

    cloud.style.cssText = `

     position:absolute;

     background:linear-gradient(135deg,rgba(255,255,255,0.2),rgba(200,230,255,0.1));

     border-radius:50px;

     filter:blur(25px);

     width:${150+Math.random()*200}px;

     height:${50+Math.random()*100}px;

     top:${20+Math.random()*60}%;

     left:${-200+Math.random()*100}%;

     animation:cloudFloat ${20+Math.random()*20}s linear infinite;

     animation-delay:${Math.random()*10}s;

    `;

    container.appendChild(cloud);

   }

   

   container.style.opacity = '1';

   

   // Add animation style

   if (!document.getElementById('cloudAnim')) {

    const style = document.createElement('style');

    style.id = 'cloudAnim';

    style.textContent = `

     @keyframes cloudFloat {

      from { transform:translateX(0); opacity:0.3; }

      to { transform:translateX(calc(100vw + 400px)); opacity:0.8; }

     }

    `;

    document.head.appendChild(style);

   }

   

  } catch (error) {

   console.log('Cloud creation failed:', error);

  }

 }

 createRain(isStorm = false) {

  try {

   const container = document.getElementById('rainContainer');

   container.innerHTML = '';

   

   const dropCount = isStorm ? 150 : 80;

   

   for (let i = 0; i < dropCount; i++) {

    const drop = document.createElement('div');

    drop.style.cssText = `

     position:absolute;

     width:2px;

     height:${15+Math.random()*20}px;

     background:linear-gradient(to bottom,rgba(0,200,255,0.8),rgba(0,100,255,0.3));

     left:${Math.random()*100}%;

     top:-20px;

     animation:rainFall ${0.5+Math.random()}s linear infinite;

     animation-delay:${Math.random()*2}s;

     opacity:${0.3+Math.random()*0.5};

    `;

    container.appendChild(drop);

   }

   

   container.style.opacity = '1';

   

   if (!document.getElementById('rainAnim')) {

    const style = document.createElement('style');

    style.id = 'rainAnim';

    style.textContent = `

     @keyframes rainFall {

      to { transform:translateY(calc(100vh + 50px)); }

     }

    `;

    document.head.appendChild(style);

   }

   

  } catch (error) {

   console.log('Rain creation failed:', error);

  }

 }

 createChart(temperatures) {

  try {

   const ctx = document.getElementById('hourChart').getContext('2d');

   

   if (this.chart) {

    this.chart.destroy();

   }

   

   const hours = [];

   for (let i = 0; i < 24; i++) {

    hours.push(`${(new Date().getHours() + i) % 24}:00`);

   }

   

   this.chart = new Chart(ctx, {

    type: 'line',

    data: {

     labels: hours,

     datasets: [{

      label: 'Temperature (¬∞C)',

      data: temperatures.slice(0, 24),

      borderColor: '#a0f',

      backgroundColor: 'rgba(160, 0, 255, 0.1)',

      borderWidth: 2,

      fill: true,

      tension: 0.4

     }]

    },

    options: {

     responsive: true,

     maintainAspectRatio: false,

     plugins: { legend: { display: false } },

     scales: {

      x: { 

       grid: { color: 'rgba(0, 255, 255, 0.1)' },

       ticks: { color: '#0ff', font: { family: 'Orbitron', size: 10 }, maxTicksLimit: 8 }

      },

      y: {

       grid: { color: 'rgba(0, 255, 255, 0.1)' },

       ticks: { color: '#0ff', font: { family: 'Orbitron', size: 10 } }

      }

     },

     animation: { duration: 1000 }

    }

   });

   

  } catch (error) {

   console.log('Chart creation failed:', error);

  }

 }

 updateForecast(dailyData) {

  try {

   const container = document.getElementById('forecastContainer');

   container.innerHTML = '';

   

   const days = ['SUN', 'MON', 'TUE', 'WED', 'THU', 'FRI', 'SAT'];

   const today = new Date();

   

   for (let i = 0; i < 7; i++) {

    const date = new Date(today);

    date.setDate(today.getDate() + i);

    const dayName = days[date.getDay()];

    

    const tempMax = dailyData.temperature_2m_max[i];

    const tempMin = dailyData.temperature_2m_min[i];

    

    const card = document.createElement('div');

    card.className = 'forecast-card';

    card.innerHTML = `

     <div class="forecast-day">${dayName}</div>

     <div class="forecast-icon">${this.weatherIcons[0] || '‚òÄÔ∏è'}</div>

     <div class="forecast-temp">${Math.round(tempMax)}¬∞</div>

     <div style="color:#888; font-size:12px;">${Math.round(tempMin)}¬∞</div>

    `;

    

    container.appendChild(card);

   }

  } catch (error) {

   console.log('Forecast update failed:', error);

  }

 }

 showMessage(message, type = 'info') {

  try {

   const element = document.getElementById('currentCity');

   element.textContent = message;

   

   const colors = {

    success: '#0f0',

    error: '#f00',

    loading: '#0ff',

    info: '#0ff'

   };

   

   element.style.color = colors[type] || colors.info;

  } catch (error) {

   console.log('Message display failed:', error);

  }

 }

}

// Initialize dashboard when page loads

window.addEventListener('load', () => {

 try {

  new WeatherDashboard();

 } catch (error) {

  console.log('Dashboard initialization failed:', error);

  document.getElementById('currentCity').textContent = 'Dashboard initialization failed';

 }

});

</script>

</body>

</html>