<!DOCTYPE html>
<html>
<head>
<title>CyberCircuit Expense Tracker</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">

<style>
/* ================= CYBERPUNK RED RESET & VARIABLES ================= */
:root {
  --neon-red: #ff003c;
  --neon-orange: #ff4d00;
  --neon-pink: #ff00ff;
  --neon-purple: #9d00ff;
  --neon-blue: #00a2ff;
  --dark-bg: #0a0005;
  --darker-bg: #050002;
  --card-bg: rgba(40, 5, 20, 0.9);
  --circuit-color: rgba(255, 0, 60, 0.3);
  --text-primary: #ffffff;
  --text-secondary: #ffb8d9;
  --glow-shadow: 0 0 20px;
  --matrix-green: #00ff41;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background-color: var(--dark-bg);
  color: var(--text-primary);
  font-family: 'Share Tech Mono', monospace;
  min-height: 100vh;
  overflow-x: hidden;
  position: relative;
  background-image: 
    radial-gradient(circle at 10% 20%, rgba(255, 0, 60, 0.15) 0%, transparent 25%),
    radial-gradient(circle at 90% 80%, rgba(255, 77, 0, 0.15) 0%, transparent 25%),
    radial-gradient(circle at 50% 50%, rgba(157, 0, 255, 0.1) 0%, transparent 30%);
}

/* ================= ANIMATED BACKGROUND ================= */
.circuit-bg {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: -2;
  overflow: hidden;
  opacity: 0.7;
}

.circuit-line {
  position: absolute;
  background: linear-gradient(90deg, transparent, var(--neon-red), var(--neon-orange), transparent);
  height: 2px;
  filter: blur(1px);
  animation: circuitFlow 8s linear infinite;
  box-shadow: 0 0 10px var(--neon-red);
}

.circuit-node {
  position: absolute;
  width: 12px;
  height: 12px;
  background: var(--neon-red);
  border-radius: 50%;
  box-shadow: 
    0 0 20px var(--neon-red),
    0 0 40px var(--neon-red);
  animation: nodePulse 1.5s infinite alternate;
  filter: blur(1px);
}

.circuit-grid {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: 
    linear-gradient(90deg, rgba(255, 0, 60, 0.1) 1px, transparent 1px),
    linear-gradient(0deg, rgba(255, 0, 60, 0.1) 1px, transparent 1px);
  background-size: 50px 50px;
  animation: gridMove 20s linear infinite;
  opacity: 0.3;
}

@keyframes circuitFlow {
  0% { 
    opacity: 0.2;
    transform: translateX(-100%) rotate(0deg);
  }
  50% { 
    opacity: 0.8;
    transform: translateX(0) rotate(180deg);
    box-shadow: 0 0 20px var(--neon-orange);
  }
  100% { 
    opacity: 0.2;
    transform: translateX(100%) rotate(360deg);
  }
}

@keyframes nodePulse {
  0% { 
    transform: scale(0.8);
    box-shadow: 
      0 0 10px var(--neon-red),
      0 0 20px var(--neon-red);
  }
  50% {
    background: var(--neon-orange);
    box-shadow: 
      0 0 25px var(--neon-orange),
      0 0 50px var(--neon-orange);
  }
  100% { 
    transform: scale(1.2);
    box-shadow: 
      0 0 30px var(--neon-red),
      0 0 60px var(--neon-red);
  }
}

@keyframes gridMove {
  0% { transform: translateY(0) translateX(0); }
  100% { transform: translateY(-50px) translateX(-50px); }
}

/* ================= HEADER SECTION ================= */
.cyber-header {
  text-align: center;
  padding: 40px 20px;
  position: relative;
  margin-bottom: 40px;
  background: linear-gradient(to bottom, 
    rgba(255, 0, 60, 0.2), 
    transparent 80%);
  border-bottom: 3px solid transparent;
  border-image: linear-gradient(90deg, 
    transparent, 
    var(--neon-red), 
    var(--neon-orange), 
    var(--neon-purple), 
    transparent) 1;
  clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
  overflow: hidden;
}

.cyber-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: repeating-linear-gradient(
    0deg,
    transparent,
    transparent 2px,
    rgba(255, 0, 60, 0.05) 2px,
    rgba(255, 0, 60, 0.05) 4px
  );
  animation: scanHeader 10s linear infinite;
  pointer-events: none;
}

@keyframes scanHeader {
  0% { transform: translateY(-100%); }
  100% { transform: translateY(100%); }
}

.main-title {
  font-family: 'Orbitron', sans-serif;
  font-size: clamp(2.8rem, 6vw, 4.5rem);
  font-weight: 900;
  background: linear-gradient(90deg, 
    var(--neon-red) 0%, 
    var(--neon-orange) 25%, 
    var(--neon-purple) 50%, 
    var(--neon-orange) 75%, 
    var(--neon-red) 100%);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  text-shadow: 
    0 0 40px rgba(255, 0, 60, 0.7),
    0 0 80px rgba(255, 77, 0, 0.5),
    0 0 120px rgba(157, 0, 255, 0.3);
  letter-spacing: 4px;
  margin-bottom: 20px;
  position: relative;
  display: inline-block;
  text-transform: uppercase;
  animation: titleGlitch 5s infinite;
}

.main-title::before,
.main-title::after {
  content: 'CYBER EXPENSE TRACKER';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  opacity: 0.3;
}

.main-title::before {
  color: var(--neon-red);
  animation: glitch1 2s infinite;
  z-index: -1;
}

.main-title::after {
  color: var(--neon-purple);
  animation: glitch2 3s infinite;
  z-index: -2;
}

@keyframes titleGlitch {
  0%, 100% { transform: translateX(0) skewX(0); }
  92% { transform: translateX(0) skewX(0); }
  94% { transform: translateX(-2px) skewX(-1deg); }
  96% { transform: translateX(2px) skewX(1deg); }
  98% { transform: translateX(-1px) skewX(-0.5deg); }
}

@keyframes glitch1 {
  0%, 100% { 
    clip-path: inset(0 0 0 0);
    transform: translateX(0);
  }
  33% { 
    clip-path: inset(10% 0 30% 0);
    transform: translateX(-3px);
  }
  66% { 
    clip-path: inset(40% 0 10% 0);
    transform: translateX(3px);
  }
}

@keyframes glitch2 {
  0%, 100% { 
    clip-path: inset(0 0 0 0);
    transform: translateX(0);
  }
  33% { 
    clip-path: inset(25% 0 25% 0);
    transform: translateX(5px);
  }
  66% { 
    clip-path: inset(15% 0 35% 0);
    transform: translateX(-5px);
  }
}

.subtitle {
  font-family: 'Orbitron', sans-serif;
  color: var(--neon-orange);
  font-size: clamp(1.2rem, 2.5vw, 1.6rem);
  letter-spacing: 3px;
  text-transform: uppercase;
  margin-bottom: 30px;
  text-shadow: 
    0 0 15px var(--neon-orange),
    0 0 30px rgba(255, 77, 0, 0.5);
  animation: subtitlePulse 3s infinite alternate;
}

@keyframes subtitlePulse {
  0% { 
    opacity: 0.7;
    text-shadow: 0 0 5px var(--neon-orange);
  }
  100% { 
    opacity: 1;
    text-shadow: 
      0 0 20px var(--neon-orange),
      0 0 40px rgba(255, 77, 0, 0.7);
  }
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 25px;
  max-width: 1000px;
  margin: 0 auto;
}

.stat-card {
  background: linear-gradient(145deg,
    rgba(255, 0, 60, 0.15),
    rgba(157, 0, 255, 0.1));
  border: 2px solid transparent;
  border-radius: 0;
  padding: 25px;
  text-align: center;
  backdrop-filter: blur(15px);
  position: relative;
  overflow: hidden;
  clip-path: polygon(
    0 0,
    calc(100% - 15px) 0,
    100% 15px,
    100% 100%,
    15px 100%,
    0 calc(100% - 15px)
  );
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.stat-card::before {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(45deg, 
    var(--neon-red), 
    var(--neon-orange), 
    var(--neon-purple), 
    var(--neon-red));
  z-index: -1;
  clip-path: polygon(
    0 0,
    calc(100% - 15px) 0,
    100% 15px,
    100% 100%,
    15px 100%,
    0 calc(100% - 15px)
  );
  opacity: 0;
  transition: opacity 0.4s;
  animation: borderRotate 3s linear infinite;
}

.stat-card:hover {
  transform: translateY(-8px) scale(1.02);
  box-shadow: 
    0 0 50px rgba(255, 0, 60, 0.4),
    0 0 100px rgba(157, 0, 255, 0.2),
    inset 0 0 60px rgba(255, 77, 0, 0.1);
}

.stat-card:hover::before {
  opacity: 1;
}

@keyframes borderRotate {
  0% { filter: hue-rotate(0deg); }
  100% { filter: hue-rotate(360deg); }
}

.stat-value {
  font-family: 'Orbitron', sans-serif;
  font-size: 2.8rem;
  color: var(--neon-orange);
  text-shadow: 
    0 0 20px var(--neon-orange),
    0 0 40px rgba(255, 77, 0, 0.5);
  margin-bottom: 10px;
  font-weight: 900;
  letter-spacing: 2px;
}

.stat-label {
  color: var(--text-secondary);
  font-size: 0.9rem;
  text-transform: uppercase;
  letter-spacing: 2px;
  font-weight: 700;
}

/* ================= MAIN LAYOUT ================= */
.main-container {
  display: grid;
  grid-template-columns: 1fr 1.5fr;
  gap: 40px;
  padding: 0 40px;
  max-width: 1800px;
  margin: 0 auto 60px;
}

@media (max-width: 1024px) {
  .main-container {
    grid-template-columns: 1fr;
    gap: 35px;
    padding: 0 25px;
  }
}

/* ================= NEON PANELS ================= */
.neon-panel {
  background: linear-gradient(145deg,
    rgba(40, 5, 20, 0.9),
    rgba(60, 10, 30, 0.7));
  border: 2px solid transparent;
  border-radius: 0;
  padding: 30px;
  backdrop-filter: blur(20px);
  position: relative;
  overflow: hidden;
  box-shadow: 
    0 10px 40px rgba(0, 0, 0, 0.5),
    inset 0 0 100px rgba(255, 0, 60, 0.1);
  clip-path: polygon(
    0 0,
    calc(100% - 20px) 0,
    100% 20px,
    100% 100%,
    20px 100%,
    0 calc(100% - 20px)
  );
}

.neon-panel::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, 
    transparent, 
    var(--neon-red), 
    var(--neon-orange), 
    var(--neon-red), 
    transparent);
  animation: scanLine 2s linear infinite;
  filter: blur(1px);
}

@keyframes scanLine {
  0% { transform: translateX(-100%); }
  100% { transform: translateX(100%); }
}

.neon-panel::after {
  content: '';
  position: absolute;
  top: -2px;
  left: -2px;
  right: -2px;
  bottom: -2px;
  background: linear-gradient(45deg, 
    var(--neon-red), 
    var(--neon-orange), 
    var(--neon-purple), 
    var(--neon-red));
  z-index: -1;
  clip-path: polygon(
    0 0,
    calc(100% - 20px) 0,
    100% 20px,
    100% 100%,
    20px 100%,
    0 calc(100% - 20px)
  );
  opacity: 0.3;
  filter: blur(8px);
}

.panel-title {
  font-family: 'Orbitron', sans-serif;
  font-size: 1.8rem;
  color: var(--neon-red);
  margin-bottom: 30px;
  display: flex;
  align-items: center;
  gap: 15px;
  text-transform: uppercase;
  letter-spacing: 3px;
  text-shadow: 
    0 0 15px var(--neon-red),
    0 0 30px rgba(255, 0, 60, 0.3);
}

.panel-title i {
  color: var(--neon-orange);
  text-shadow: 
    0 0 15px var(--neon-orange),
    0 0 30px rgba(255, 77, 0, 0.5);
  animation: iconPulse 2s infinite alternate;
}

@keyframes iconPulse {
  0% { 
    transform: scale(1);
    color: var(--neon-red);
  }
  100% { 
    transform: scale(1.2);
    color: var(--neon-orange);
  }
}

/* ================= FORM ELEMENTS ================= */
.input-row {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 25px;
  margin-bottom: 30px;
}

@media (max-width: 768px) {
  .input-row {
    grid-template-columns: 1fr;
  }
}

.input-group {
  margin-bottom: 25px;
  position: relative;
}

.cyber-label {
  display: block;
  color: var(--neon-orange);
  font-family: 'Orbitron', sans-serif;
  font-size: 1rem;
  margin-bottom: 12px;
  text-transform: uppercase;
  letter-spacing: 2px;
  text-shadow: 0 0 10px var(--neon-orange);
}

.cyber-input {
  width: 100%;
  padding: 18px;
  background: rgba(20, 0, 10, 0.7);
  border: 2px solid rgba(255, 0, 60, 0.4);
  border-radius: 0;
  color: var(--text-primary);
  font-family: 'Share Tech Mono', monospace;
  font-size: 1.1rem;
  font-weight: bold;
  transition: all 0.3s ease;
  position: relative;
  clip-path: polygon(
    0 0,
    calc(100% - 12px) 0,
    100% 12px,
    100% 100%,
    12px 100%,
    0 calc(100% - 12px)
  );
}

.cyber-input:focus {
  outline: none;
  border-color: var(--neon-orange);
  box-shadow: 
    0 0 30px rgba(255, 77, 0, 0.4),
    inset 0 0 20px rgba(255, 0, 60, 0.1);
  background: rgba(40, 0, 20, 0.9);
}

.cyber-input::placeholder {
  color: rgba(255, 184, 217, 0.5);
  font-style: italic;
}

/* ================= UPLOAD BUTTON ================= */
.upload-container {
  margin: 30px 0;
  position: relative;
}

.cyber-upload {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 20px;
  padding: 25px;
  background: linear-gradient(145deg,
    rgba(255, 0, 60, 0.15),
    rgba(157, 0, 255, 0.1));
  border: 3px dashed rgba(255, 0, 60, 0.4);
  border-radius: 0;
  cursor: pointer;
  transition: all 0.3s ease;
  color: var(--neon-red);
  font-family: 'Orbitron', sans-serif;
  font-weight: 700;
  font-size: 1.1rem;
  text-align: center;
  position: relative;
  overflow: hidden;
  clip-path: polygon(
    0 0,
    calc(100% - 15px) 0,
    100% 15px,
    100% 100%,
    15px 100%,
    0 calc(100% - 15px)
  );
  text-transform: uppercase;
  letter-spacing: 2px;
}

.cyber-upload::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg,
    transparent,
    rgba(255, 255, 255, 0.1),
    transparent);
  transition: 0.5s;
}

.cyber-upload:hover {
  background: linear-gradient(145deg,
    rgba(255, 0, 60, 0.25),
    rgba(157, 0, 255, 0.2));
  border-color: var(--neon-orange);
  box-shadow: 
    0 0 40px rgba(255, 77, 0, 0.3),
    inset 0 0 30px rgba(255, 0, 60, 0.2);
  transform: translateY(-3px);
}

.cyber-upload:hover::before {
  left: 100%;
}

.cyber-upload input {
  display: none;
}

/* ================= IMAGE PREVIEW ================= */
#previewContainer {
  margin: 25px 0;
  text-align: center;
}

.preview-image {
  max-width: 100%;
  max-height: 250px;
  border-radius: 0;
  border: 3px solid var(--neon-red);
  box-shadow: 
    0 0 30px rgba(255, 0, 60, 0.5),
    0 0 60px rgba(255, 0, 60, 0.3);
  margin-top: 20px;
  clip-path: polygon(
    0 0,
    calc(100% - 15px) 0,
    100% 15px,
    100% 100%,
    15px 100%,
    0 calc(100% - 15px)
  );
  transition: all 0.3s ease;
  filter: hue-rotate(-10deg) saturate(1.2);
}

.preview-image:hover {
  transform: scale(1.02);
  box-shadow: 
    0 0 40px rgba(255, 0, 60, 0.7),
    0 0 80px rgba(255, 0, 60, 0.4);
  border-color: var(--neon-orange);
}

/* ================= BUTTONS ================= */
.button-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 20px;
  margin-top: 40px;
}

.cyber-btn {
  padding: 22px;
  font-family: 'Orbitron', sans-serif;
  font-weight: 900;
  font-size: 1.1rem;
  text-transform: uppercase;
  letter-spacing: 3px;
  border: none;
  border-radius: 0;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 15px;
  position: relative;
  overflow: hidden;
  clip-path: polygon(
    0 0,
    calc(100% - 12px) 0,
    100% 12px,
    100% 100%,
    12px 100%,
    0 calc(100% - 12px)
  );
}

.cyber-btn::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, 
    transparent, 
    rgba(255, 255, 255, 0.3), 
    transparent);
  transition: 0.5s;
}

.cyber-btn:hover::before {
  left: 100%;
}

.btn-save {
  background: linear-gradient(145deg,
    var(--neon-red),
    var(--neon-orange));
  color: #000;
  box-shadow: 
    0 0 30px rgba(255, 0, 60, 0.6),
    0 5px 20px rgba(0, 0, 0, 0.4);
  text-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
}

.btn-save:hover {
  transform: translateY(-5px);
  box-shadow: 
    0 0 50px rgba(255, 0, 60, 0.8),
    0 10px 30px rgba(0, 0, 0, 0.5);
}

.btn-gps {
  background: linear-gradient(145deg,
    rgba(255, 0, 60, 0.3),
    rgba(255, 77, 0, 0.2));
  color: var(--neon-orange);
  border: 2px solid var(--neon-orange);
  box-shadow: 
    0 0 25px rgba(255, 77, 0, 0.3),
    inset 0 0 20px rgba(255, 0, 60, 0.1);
}

.btn-gps:hover {
  background: linear-gradient(145deg,
    rgba(255, 0, 60, 0.4),
    rgba(255, 77, 0, 0.3));
  transform: translateY(-5px);
  box-shadow: 
    0 0 40px rgba(255, 77, 0, 0.5),
    inset 0 0 30px rgba(255, 0, 60, 0.2);
}

.btn-clear {
  background: linear-gradient(145deg,
    rgba(255, 0, 60, 0.3),
    rgba(157, 0, 255, 0.2));
  color: #ff003c;
  border: 2px solid #ff003c;
  box-shadow: 
    0 0 25px rgba(255, 0, 60, 0.3),
    inset 0 0 20px rgba(157, 0, 255, 0.1);
}

.btn-clear:hover {
  background: linear-gradient(145deg,
    rgba(255, 0, 60, 0.4),
    rgba(157, 0, 255, 0.3));
  transform: translateY(-5px);
  box-shadow: 
    0 0 40px rgba(255, 0, 60, 0.5),
    inset 0 0 30px rgba(157, 0, 255, 0.2);
}

/* ================= MAP CONTAINER ================= */
.map-wrapper {
  height: 100%;
  min-height: 550px;
  position: relative;
}

#map {
  height: 100%;
  border-radius: 0;
  border: 3px solid var(--neon-red);
  box-shadow: 
    0 0 50px rgba(255, 0, 60, 0.4),
    inset 0 0 50px rgba(255, 0, 60, 0.1);
  z-index: 1;
  clip-path: polygon(
    0 0,
    calc(100% - 15px) 0,
    100% 15px,
    100% 100%,
    15px 100%,
    0 calc(100% - 15px)
  );
}

.map-overlay {
  position: absolute;
  top: 20px;
  right: 20px;
  background: rgba(0, 0, 0, 0.9);
  border: 2px solid var(--neon-orange);
  padding: 12px 20px;
  border-radius: 0;
  font-family: 'Orbitron', sans-serif;
  font-size: 1rem;
  color: var(--neon-orange);
  z-index: 1000;
  box-shadow: 0 0 25px rgba(255, 77, 0, 0.4);
  display: flex;
  align-items: center;
  gap: 10px;
  clip-path: polygon(
    0 0,
    calc(100% - 8px) 0,
    100% 8px,
    100% 100%,
    8px 100%,
    0 calc(100% - 8px)
  );
  text-transform: uppercase;
  letter-spacing: 2px;
}

/* ================= EXPENSE LIST ================= */
.history-section {
  grid-column: 1 / -1;
  margin-top: 50px;
}

.expense-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
  gap: 30px;
  margin-top: 30px;
}

@media (max-width: 768px) {
  .expense-grid {
    grid-template-columns: 1fr;
  }
}

.expense-item {
  background: linear-gradient(145deg,
    rgba(50, 10, 25, 0.9),
    rgba(70, 20, 35, 0.7));
  border: 2px solid rgba(255, 0, 60, 0.3);
  border-radius: 0;
  padding: 25px;
  position: relative;
  overflow: hidden;
  transition: all 0.3s ease;
  clip-path: polygon(
    0 0,
    calc(100% - 15px) 0,
    100% 15px,
    100% 100%,
    15px 100%,
    0 calc(100% - 15px)
  );
}

.expense-item::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 4px;
  background: linear-gradient(90deg, 
    transparent, 
    var(--neon-red), 
    var(--neon-orange), 
    transparent);
  transform: translateX(-100%);
  transition: transform 0.5s;
}

.expense-item:hover {
  transform: translateY(-8px) scale(1.02);
  border-color: var(--neon-orange);
  box-shadow: 
    0 0 40px rgba(255, 77, 0, 0.3),
    0 10px 30px rgba(0, 0, 0, 0.4),
    inset 0 0 40px rgba(255, 0, 60, 0.1);
}

.expense-item:hover::before {
  transform: translateX(100%);
}

.expense-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
  padding-bottom: 15px;
  border-bottom: 2px solid rgba(255, 0, 60, 0.2);
}

.expense-amount {
  font-family: 'Orbitron', sans-serif;
  font-size: 2.2rem;
  color: var(--neon-orange);
  text-shadow: 
    0 0 15px var(--neon-orange),
    0 0 30px rgba(255, 77, 0, 0.4);
  font-weight: 900;
  letter-spacing: 1px;
}

.expense-time {
  font-size: 0.9rem;
  color: var(--text-secondary);
  background: rgba(255, 0, 60, 0.15);
  padding: 8px 15px;
  border-radius: 0;
  font-family: 'Share Tech Mono', monospace;
  font-weight: bold;
  clip-path: polygon(
    0 0,
    calc(100% - 5px) 0,
    100% 5px,
    100% 100%,
    5px 100%,
    0 calc(100% - 5px)
  );
}

.expense-note {
  font-size: 1.2rem;
  color: white;
  margin-bottom: 15px;
  line-height: 1.4;
  font-weight: bold;
  text-shadow: 0 0 10px rgba(255, 255, 255, 0.3);
}

.expense-location {
  display: flex;
  align-items: center;
  gap: 10px;
  color: var(--neon-red);
  font-size: 1rem;
  margin-bottom: 20px;
  font-family: 'Share Tech Mono', monospace;
  font-weight: bold;
}

.expense-image {
  width: 100%;
  max-height: 200px;
  object-fit: cover;
  border-radius: 0;
  margin-top: 20px;
  border: 2px solid rgba(255, 0, 60, 0.4);
  cursor: pointer;
  transition: all 0.3s ease;
  clip-path: polygon(
    0 0,
    calc(100% - 12px) 0,
    100% 12px,
    100% 100%,
    12px 100%,
    0 calc(100% - 12px)
  );
}

.expense-image:hover {
  transform: scale(1.03);
  border-color: var(--neon-orange);
  box-shadow: 
    0 0 30px rgba(255, 0, 60, 0.6),
    0 0 60px rgba(255, 0, 60, 0.3);
}

/* ================= EXPORT BAR ================= */
.export-bar {
  display: flex;
  justify-content: center;
  gap: 25px;
  margin: 50px 0;
  padding: 0 30px;
  flex-wrap: wrap;
}

.export-btn {
  padding: 18px 35px;
  background: linear-gradient(145deg,
    rgba(0, 0, 0, 0.8),
    rgba(40, 5, 20, 0.6));
  border: 2px solid var(--neon-orange);
  color: var(--neon-orange);
  font-family: 'Orbitron', sans-serif;
  font-weight: 700;
  border-radius: 0;
  cursor: pointer;
  transition: all 0.3s ease;
  display: flex;
  align-items: center;
  gap: 12px;
  min-width: 200px;
  justify-content: center;
  clip-path: polygon(
    0 0,
    calc(100% - 12px) 0,
    100% 12px,
    100% 100%,
    12px 100%,
    0 calc(100% - 12px)
  );
  text-transform: uppercase;
  letter-spacing: 2px;
}

.export-btn:hover {
  background: linear-gradient(145deg,
    rgba(255, 77, 0, 0.2),
    rgba(255, 0, 60, 0.1));
  box-shadow: 
    0 0 30px rgba(255, 77, 0, 0.4),
    0 0 60px rgba(255, 77, 0, 0.2);
  transform: translateY(-5px);
  border-color: var(--neon-red);
}

/* ================= MODAL FOR IMAGE VIEW ================= */
.image-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.98);
  z-index: 10000;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(20px);
}

.modal-content {
  max-width: 90%;
  max-height: 90%;
  border: 4px solid var(--neon-red);
  border-radius: 0;
  box-shadow: 
    0 0 60px rgba(255, 0, 60, 0.7),
    0 0 120px rgba(255, 77, 0, 0.5);
  clip-path: polygon(
    0 0,
    calc(100% - 25px) 0,
    100% 25px,
    100% 100%,
    25px 100%,
    0 calc(100% - 25px)
  );
}

.close-modal {
  position: absolute;
  top: 30px;
  right: 40px;
  color: white;
  font-size: 3rem;
  cursor: pointer;
  transition: all 0.3s;
  text-shadow: 0 0 20px var(--neon-red);
}

.close-modal:hover {
  color: var(--neon-orange);
  transform: scale(1.2);
}

/* ================= SCANLINES EFFECT ================= */
.scanlines {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(
    to bottom,
    transparent 50%,
    rgba(255, 0, 60, 0.05) 50%
  );
  background-size: 100% 6px;
  pointer-events: none;
  z-index: 9998;
  animation: scanlines 8s linear infinite;
  mix-blend-mode: overlay;
}

@keyframes scanlines {
  0% { background-position: 0 0; }
  100% { background-position: 0 100%; }
}

/* ================= RESPONSIVE DESIGN ================= */
@media (max-width: 768px) {
  .cyber-header {
    padding: 30px 15px;
    clip-path: polygon(0 0, 100% 0, 100% 90%, 0 95%);
  }
  
  .stats-grid {
    grid-template-columns: 1fr;
    gap: 20px;
  }
  
  .neon-panel {
    padding: 25px;
  }
  
  .button-grid {
    gap: 15px;
  }
  
  .cyber-btn {
    padding: 20px;
    font-size: 1rem;
  }
  
  .map-wrapper {
    min-height: 450px;
  }
  
  .export-bar {
    flex-direction: column;
    align-items: center;
    gap: 15px;
  }
  
  .export-btn {
    width: 100%;
    max-width: 350px;
  }
}

/* ================= CUSTOM MAP MARKERS ================= */
.cyber-marker {
  background: radial-gradient(circle, 
    var(--neon-red) 30%, 
    var(--neon-orange) 70%);
  width: 35px;
  height: 35px;
  border-radius: 50% 50% 50% 0;
  transform: rotate(-45deg);
  border: 3px solid white;
  box-shadow: 
    0 0 25px var(--neon-red),
    0 0 50px rgba(255, 77, 0, 0.5);
  animation: markerPulse 1.5s infinite alternate;
  filter: drop-shadow(0 0 10px var(--neon-red));
}

@keyframes markerPulse {
  0%, 100% { 
    box-shadow: 
      0 0 25px var(--neon-red),
      0 0 50px rgba(255, 77, 0, 0.5);
  }
  50% { 
    box-shadow: 
      0 0 35px var(--neon-red),
      0 0 70px rgba(255, 77, 0, 0.7);
    transform: rotate(-45deg) scale(1.1);
  }
}

/* ================= LOADING ANIMATION ================= */
.loading-spinner {
  display: inline-block;
  width: 25px;
  height: 25px;
  border: 4px solid rgba(255, 0, 60, 0.3);
  border-radius: 50%;
  border-top-color: var(--neon-red);
  animation: spin 1s linear infinite;
  box-shadow: 0 0 15px rgba(255, 0, 60, 0.5);
}

/* ================= PULSING GLOW EFFECTS ================= */
@keyframes pulseGlow {
  0%, 100% {
    box-shadow: 0 0 20px rgba(255, 0, 60, 0.5);
  }
  50% {
    box-shadow: 0 0 40px rgba(255, 0, 60, 0.8);
  }
}

.neon-panel,
.stat-card,
.expense-item,
.cyber-btn,
.export-btn {
  animation: pulseGlow 3s infinite alternate;
}

/* ================= MATRIX RAIN EFFECT ================= */
.matrix-rain {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: -1;
  opacity: 0.1;
}

.rain-column {
  position: absolute;
  top: -100px;
  color: var(--matrix-green);
  font-size: 20px;
  font-family: 'Share Tech Mono', monospace;
  animation: rainFall linear infinite;
}

@keyframes rainFall {
  0% {
    transform: translateY(-100px);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    transform: translateY(100vh);
    opacity: 0;
  }
}
.cyber-notification {
  font-family: 'Orbitron', sans-serif;
  text-transform: uppercase;
  letter-spacing: 1px;
}
</style>
</head>
<body>
<div class="circuit-bg">
  <div class="circuit-line" style="top:15%;width:80%;height:3px;"></div>
  <div class="circuit-node" style="top:15%;left:60%;"></div>
  <div class="circuit-line" style="top:60%;width:60%;height:3px;"></div>
  <div class="circuit-node" style="top:60%;left:20%;"></div>
</div>
<div class="scanlines"></div>

<header class="cyber-header">
  <h1 class="main-title">CYBER EXPENSE TRACKER</h1>
  <p class="subtitle">Neon UI ‚Ä¢ GPS Logging ‚Ä¢ Map Based Expense Memory</p>
</header>

<div class="main-container">

  <!-- Add Expense Panel -->
  <section class="neon-panel">

    <div class="panel-title"><i>‚ûï</i> Add New Expense</div>

    <div class="input-row">
      <div class="input-group">
        <label class="cyber-label">Amount (‚Çπ)</label>
        <input id="amt" class="cyber-input" type="number" required>
      </div>

      <div class="input-group">
        <label class="cyber-label">Note</label>
        <input id="note" class="cyber-input" type="text" required>
      </div>
    </div>

    <div class="upload-container">
      <label class="cyber-upload">
        üì∑ Upload Receipt / Photo
        <input id="photo" type="file" accept="image/*" capture="camera">
      </label>
      <div id="previewContainer"></div>
    </div>

    <div class="button-grid">
      <button class="cyber-btn btn-save" onclick="document.querySelector('.btn-save').click()">üíæ Save Expense</button>
      <button class="cyber-btn btn-gps" onclick="getLocation()">üìç Use GPS</button>
      <button class="cyber-btn btn-clear" onclick="clearAll()">üóë Clear All</button>
    </div>

  </section>

  <!-- Map Panel -->
  <section class="neon-panel">
    <div class="panel-title"><i>üìç</i> Map</div>
    <div class="map-wrapper">
      <div id="map"></div>
      <div class="map-overlay">Tap to set location</div>
    </div>
  </section>

  <!-- Expense History -->
  <section class="history-section">
    <div class="panel-title"><i>üìú</i> Expense History</div>
    <div id="list" class="expense-grid"></div>
  </section>

</div>

<!-- Export -->
<div class="export-bar">
  <button class="export-btn" onclick="backupJSON()">üìÅ Export JSON</button>
  <button class="export-btn" onclick="backupCSV()">üìä Export CSV</button>
</div>

<!-- Image modal -->
<div id="modal" class="image-modal">
  <span class="close-modal" onclick="modal.style.display='none'">&times;</span>
  <img id="modalImg" class="modal-content">
</div>
<script>
// ================= GLOBAL VARIABLES =================
let map, currentLocation = null, locationName = "Unknown", compressedImage = null;
let selectedMarker = null, expenses = JSON.parse(localStorage.getItem("cyberExpenses") || "[]");

// ================= NOTIFICATION SYSTEM =================
function showNotification(message, type = "info") {
  document.querySelectorAll('.cyber-notification').forEach(n => n.remove());
  
  const notification = document.createElement('div');
  notification.className = 'cyber-notification';
  
  const colors = {
    success: { bg: 'rgba(0, 255, 100, 0.15)', border: '#00ff64', icon: '‚úì' },
    error: { bg: 'rgba(255, 0, 60, 0.15)', border: '#ff003c', icon: '‚úó' },
    warning: { bg: 'rgba(255, 77, 0, 0.15)', border: '#ff4d00', icon: '‚ö†' },
    info: { bg: 'rgba(0, 163, 255, 0.15)', border: '#00a3ff', icon: '‚Ñπ' }
  };
  
  const style = colors[type] || colors.info;
  
  notification.innerHTML = `
    <div style="
      background: ${style.bg};
      border: 1px solid ${style.border};
      color: ${style.border};
      padding: 15px 25px;
      border-radius: 0;
      font-family: 'Orbitron', sans-serif;
      font-weight: 600;
      letter-spacing: 1px;
      display: flex;
      align-items: center;
      gap: 15px;
      min-width: 300px;
      backdrop-filter: blur(10px);
      box-shadow: 0 0 30px ${style.border}80;
      clip-path: polygon(0 0, calc(100% - 10px) 0, 100% 10px, 100% 100%, 10px 100%, 0 calc(100% - 10px));
      border-left: 4px solid ${style.border};
    ">
      <span style="font-size: 1.2rem;">${style.icon}</span>
      <span>${message}</span>
    </div>
  `;
  
  notification.style.cssText = `
    position: fixed;
    top: 30px;
    right: 30px;
    z-index: 10002;
    animation: notificationSlideIn 0.3s ease;
  `;
  
  document.body.appendChild(notification);
  
  if (!document.querySelector('#notificationStyles')) {
    const styleEl = document.createElement('style');
    styleEl.id = 'notificationStyles';
    styleEl.textContent = `
      @keyframes notificationSlideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes notificationSlideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(100%); opacity: 0; }
      }
    `;
    document.head.appendChild(styleEl);
  }
  
  setTimeout(() => {
    notification.style.animation = 'notificationSlideOut 0.3s ease';
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

// ================= INITIALIZATION =================
document.addEventListener('DOMContentLoaded', function() {
  initializeApp();
  createCircuitBackground();
});

function initializeApp() {
  const savedLocation = JSON.parse(localStorage.getItem("lastLocation") || "null");
  savedLocation ? initializeMap(savedLocation.lat, savedLocation.lng) : initializeMap(28.6139, 77.2090);
  loadExpenses();
}

function initializeMap(lat, lng) {
  map = L.map('map').setView([lat, lng], 13);
  L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
    attribution: '¬© OpenStreetMap',
    maxZoom: 19
  }).addTo(map);
  map.on('click', handleMapClick);
}

// ================= BASIC FUNCTIONS =================
function getLocation() {
  if (!navigator.geolocation) {
    showNotification("Geolocation not supported by your browser", "error");
    return;
  }
  navigator.geolocation.getCurrentPosition(async function(pos) {
    currentLocation = { lat: pos.coords.latitude, lng: pos.coords.longitude };
    localStorage.setItem("lastLocation", JSON.stringify(currentLocation));
    map.setView([currentLocation.lat, currentLocation.lng], 16);
    
    try {
      const response = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${currentLocation.lat}&lon=${currentLocation.lng}&format=json`);
      const data = await response.json();
      locationName = data.display_name || "GPS Location";
    } catch (error) {
      locationName = "GPS Location";
    }
    updateMapMarker();
    showNotification("Location set: " + locationName.substring(0, 50), "success");
  }, function() {
    showNotification("GPS access denied. Click map instead.", "error");
  });
}

function clearAll() {
  if (confirm("‚ö†Ô∏è DELETE ALL EXPENSE DATA?\nThis cannot be undone!")) {
    localStorage.clear();
    expenses = [];
    showNotification("All data purged successfully", "success");
    setTimeout(() => location.reload(), 1500);
  }
}

// ================= MAP FUNCTIONS =================
async function handleMapClick(e) {
  currentLocation = { lat: e.latlng.lat, lng: e.latlng.lng };
  localStorage.setItem("lastLocation", JSON.stringify(currentLocation));
  
  try {
    const response = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${currentLocation.lat}&lon=${currentLocation.lng}&format=json`);
    const data = await response.json();
    locationName = data.display_name || "Selected Location";
  } catch (error) {
    locationName = "Selected Location";
  }
  updateMapMarker();
}

function updateMapMarker() {
  if (selectedMarker) map.removeLayer(selectedMarker);
  
  const customIcon = L.divIcon({
    html: '<div class="cyber-marker"></div>',
    iconSize: [30, 30],
    className: 'custom-marker'
  });
  
  selectedMarker = L.marker([currentLocation.lat, currentLocation.lng], { icon: customIcon })
    .addTo(map)
    .bindPopup(`<b>üìç Location</b><br>${locationName.substring(0, 60)}...`)
    .openPopup();
}

// ================= IMAGE HANDLING =================
document.getElementById('photo').addEventListener('change', async function() {
  const previewContainer = document.getElementById('previewContainer');
  if (this.files[0]) {
    try {
      compressedImage = await compressImage(this.files[0]);
      previewContainer.innerHTML = `<img src="${compressedImage}" class="preview-image">`;
    } catch (error) {
      compressedImage = null;
      previewContainer.innerHTML = '<div style="color:#ff4d00;padding:10px;">Image failed to load</div>';
    }
  }
});

function compressImage(file) {
  return new Promise((resolve) => {
    const reader = new FileReader();
    reader.onload = function(e) {
      const img = new Image();
      img.src = e.target.result;
      img.onload = function() {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 800;
        canvas.height = img.height * (800 / img.width);
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        resolve(canvas.toDataURL('image/jpeg', 0.7));
      }
    }
    reader.readAsDataURL(file);
  });
}

// ================= EXPENSE HANDLING =================
// FIX: Form submit event listener instead of button click
const saveBtn = document.querySelector('.btn-save');
if (saveBtn) {
  saveBtn.addEventListener('click', function(e) {
    e.preventDefault();
    
    const amt = document.getElementById('amt').value;
    const note = document.getElementById('note').value;
    
    if (!amt || !note) {
      showNotification("Please fill amount and note", "warning");
      return;
    }
    
    if (!currentLocation) {
      showNotification("Please set location first", "warning");
      return;
    }
    
    const expense = {
      id: Date.now(),
      amount: parseFloat(amt).toFixed(2),
      note: note,
      location: locationName,
      image: compressedImage || null,
      timestamp: new Date().toLocaleString(),
      coordinates: currentLocation
    };
    
    expenses.push(expense);
    localStorage.setItem("cyberExpenses", JSON.stringify(expenses));
    addExpenseToMap(expense);
    addExpenseToList(expense);
    
    document.getElementById('amt').value = '';
    document.getElementById('note').value = '';
    document.getElementById('previewContainer').innerHTML = '';
    compressedImage = null;
    showNotification(`Expense ‚Çπ${expense.amount} saved successfully!`, "success");
  });
}

function addExpenseToMap(expense) {
  const customIcon = L.divIcon({
    html: '<div class="cyber-marker"><i style="color:white;font-size:12px;">‚Çπ</i></div>',
    iconSize: [40, 40],
    className: 'expense-marker'
  });
  
  L.marker([expense.coordinates.lat, expense.coordinates.lng], { icon: customIcon })
    .addTo(map)
    .bindPopup(`
      <div style="min-width:200px;">
        <b style="color:#ff4d00;">‚Çπ${expense.amount}</b><br>
        ${expense.note}<br>
        <small>${expense.location.substring(0, 40)}...</small>
        ${expense.image ? `<br><img src="${expense.image}" width="200">` : ''}
      </div>
    `);
}

function addExpenseToList(expense) {
  const list = document.getElementById('list');
  const item = document.createElement('div');
  item.className = 'expense-item';
  item.innerHTML = `
    <div class="expense-header">
      <div class="expense-amount">‚Çπ${expense.amount}</div>
      <div class="expense-time">${expense.timestamp}</div>
    </div>
    <div class="expense-note">${expense.note}</div>
    <div class="expense-location">üìç ${expense.location.substring(0, 60)}...</div>
    ${expense.image ? `<img src="${expense.image}" class="expense-image" onclick="modalImg.src='${expense.image}';modal.style.display='flex'">` : ''}
    <button onclick="deleteExpense(${expense.id})" style="margin-top:10px;padding:5px 10px;background:#ff0033;border:none;color:white;cursor:pointer;">Delete</button>
  `;
  list.prepend(item);
}

// ================= LOAD EXPENSES =================
function loadExpenses() {
  const list = document.getElementById('list');
  if (expenses.length === 0) {
    list.innerHTML = `
      <div class="expense-item" style="text-align:center;padding:40px;grid-column:1/-1">
        <i style="font-size:3rem;color:#ff4d00;">üìä</i>
        <h3>No expenses</h3>
        <p>Add your first expense</p>
      </div>
    `;
    return;
  }
  
  list.innerHTML = '';
  expenses.forEach(expense => {
    addExpenseToMap(expense);
    addExpenseToList(expense);
  });
}

function deleteExpense(id) {
  if (!confirm("Delete expense?")) return;
  expenses = expenses.filter(expense => expense.id !== id);
  localStorage.setItem("cyberExpenses", JSON.stringify(expenses));
  loadExpenses();
  showNotification("Expense deleted", "success");
}

// ================= EXPORT FUNCTIONS =================
function backupJSON() {
  if (expenses.length === 0) {
    showNotification("No expenses to export", "warning");
    return;
  }
  const dataStr = JSON.stringify(expenses, null, 2);
  const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);
  const link = document.createElement('a');
  link.href = dataUri;
  link.download = 'expenses.json';
  link.click();
  showNotification("JSON exported successfully", "success");
}

function backupCSV() {
  if (expenses.length === 0) {
    showNotification("No expenses to export", "warning");
    return;
  }
  let csv = 'Amount,Note,Location,Time,Lat,Lng\n';
  expenses.forEach(expense => {
    csv += `"${expense.amount}","${expense.note.replace(/"/g, '""')}","${expense.location.replace(/"/g, '""')}","${expense.timestamp}",${expense.coordinates.lat},${expense.coordinates.lng}\n`;
  });
  const dataUri = 'data:text/csv;charset=utf-8,' + encodeURIComponent(csv);
  const link = document.createElement('a');
  link.href = dataUri;
  link.download = 'expenses.csv';
  link.click();
  showNotification("CSV exported successfully", "success");
}

// ================= CIRCUIT BACKGROUND =================
function createCircuitBackground() {
  const container = document.querySelector('.circuit-bg');
  for (let i = 0; i < 15; i++) {
    const node = document.createElement('div');
    node.className = 'circuit-node';
    node.style.cssText = `top:${Math.random()*100}%;left:${Math.random()*100}%;`;
    container.appendChild(node);
  }
}

// ================= MODAL FUNCTIONS =================
const modal = document.getElementById('modal');
const modalImg = document.getElementById('modalImg');

window.onclick = function(event) {
  if (event.target === modal) {
    modal.style.display = 'none';
  }
};
</script>
</body>
</html>